(this["webpackJsonpreact-save-links"]=this["webpackJsonpreact-save-links"]||[]).push([[0],{80:function(e,t,n){e.exports=n(91)},85:function(e,t,n){},91:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(10),c=n.n(i),o=(n(85),n(141)),u=n(151),s=n(6),l=n.n(s),p=n(9),d=n(16),f=n(138),h=n(148),k=n(154),y=n(152),v=n(149),m=n(142),b=n(144),E=n(143),O=n(63),x=n.n(O),w=n(19),g=n(140),H=n(150),j=n(155),S=n(139),D=n(135),I=n(136),N=n(134),T='You must enter a hyperlink to be saved for later. E.g. "https://example.com"',A='The hyperlink you entered is not valid. Valid example: "https://example.com"';function B(e){var t=a.a.useState(e.title||""),n=Object(d.a)(t,2),r=n[0],i=n[1],c=a.a.useState(e.url||"https://"),o=Object(d.a)(c,2),u=o[0],s=o[1],l=a.a.useState(null),p=Object(d.a)(l,2),f=p[0],h=p[1],k=function(){""===u.trim()?h(T):y(u)?(h(null),e.id?v():m(),E()):h(A)},y=function(e){return e.length>9&&("http://"===e.substr(0,7)||"https://"===e.substr(0,8))},v=function(){var t=Object(w.a)({id:e.id},b());e.onUpdateHyperlink(t)},m=function(){var t=b();e.onSaveNewHyperlink(t)},b=function(){var e={url:u.trim()};return r&&(e.title=r.trim()),e},E=function(){e.onCloseDialog()};return a.a.createElement(j.a,{"aria-labelledby":"form-dialog-title",open:e.open,onEnter:function(){i(e.title||""),s(e.url||"https://"),h(null)},onClose:E},a.a.createElement(N.a,{id:"form-dialog-title"},"Save For Later"),a.a.createElement(D.a,null,a.a.createElement(I.a,null,"What do you want to read, watch, play or listen to?"),a.a.createElement(H.a,{margin:"dense",type:"text",fullWidth:!0,id:"title",label:"Title (optional)",value:r,onChange:function(e){return i(e.target.value)}}),a.a.createElement(H.a,{autoFocus:!0,margin:"dense",type:"text",required:!0,fullWidth:!0,error:f,helperText:f||" ",id:"url",label:"Url",onKeyUp:function(e){"Enter"===e.key&&k()},value:u,onChange:function(e){return s(e.target.value)}})),a.a.createElement(S.a,null,a.a.createElement(g.a,{color:"primary",onClick:E},"Cancel"),a.a.createElement(g.a,{color:"primary",onClick:k,"data-testid":"savebutton"},"Save Link")))}var C=Object(o.a)((function(e){return{addHyperlink:{color:e.palette.text.hint}}}));function R(e){var t=C(),n=a.a.useState(!1),r=Object(d.a)(n,2),i=r[0],c=r[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(m.a,{className:t.addHyperlink,button:!0,component:"button",onClick:function(){c(!0)}},a.a.createElement(E.a,null,a.a.createElement(x.a,null)),a.a.createElement(b.a,null,"New Hyperlink")),a.a.createElement(B,{url:"https://",open:i,onCloseDialog:function(){c(!1)},onSaveNewHyperlink:e.onSaveNewHyperlink}))}var U=n(145),_=n(147),L=n(146),F=n(64),P=n.n(F),z=n(65),M=n.n(z),V=Object(o.a)((function(e){return{hyperlink:{color:"blue"},hyperlinkVisited:{color:"purple",textDecorationLine:"line-through"}}}));function W(e){return a.a.createElement(X,{id:e.id,title:e.title,url:e.url,onUpdateHyperlink:e.onUpdateHyperlink},a.a.createElement(E.a,null,a.a.createElement(P.a,null)),a.a.createElement(J,{id:e.id,title:e.title,url:e.url,visited:e.visited,onUpdateHyperlinkAsVisited:function(){var t={id:e.id,visited:!0};e.onUpdateHyperlink(t)}}),a.a.createElement(U.a,null,a.a.createElement(L.a,{onClick:function(){var t={id:e.id};e.onDeleteHyperlink(t)}},a.a.createElement(M.a,null))))}function X(e){var t=V(),n=a.a.useState(!1),r=Object(d.a)(n,2),i=r[0],c=r[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement(m.a,{className:e.visited?t.hyperlinkVisited:t.hyperlink,button:!0,component:"button",onClick:function(){c(!0)}},e.children),a.a.createElement(B,{id:e.id,title:e.title,url:e.url,open:i,onCloseDialog:function(){c(!1)},onUpdateHyperlink:e.onUpdateHyperlink}))}function J(e){var t=V(),n=function(){var t={id:e.id,visited:!0};e.onUpdateHyperlinkAsVisited(t)};return a.a.createElement(b.a,null,a.a.createElement(_.a,{className:e.visited?t.hyperlinkVisited:t.hyperlink,button:"true",component:"a",href:e.url,target:"_blank",rel:"noopener noreferrer",onClick:function(e){n(),e.stopPropagation()}},e.title||e.url))}var Y=n(43),Z=n(32),q=n(33),K=n(55),$=new(function(){function e(){Object(Z.a)(this,e),this.DATABASE_NAME="savelinksforlater",this.DATABASE_VERSION=2,this._db=void 0,this.ERROR={INDEXEDDB_NOT_SUPPORTED:"IndexedDB is not supported by client",INDEXEDDB_NOT_INITIALIZED:"IndexedDB store was not intialized and cannot be used"}}return Object(q.a)(e,[{key:"getHyperlinks",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwErrorIfIndexedDBNotInitialized(),e.next=3,this._db.getAllFromIndex("hyperlinks","createdOn");case 3:return t=e.sent,e.abrupt("return",t&&this.convertArrayToObject(t,"id"));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addOrUpdateHyperlink",value:function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwErrorIfIndexedDBNotInitialized(),e.next=3,this._db.put("hyperlinks",t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteHyperlink",value:function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwErrorIfIndexedDBNotInitialized(),e.next=3,this._db.delete("hyperlinks",t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteIndexedDb",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwErrorIfIndexedDBNotInitialized(),e.next=3,Object(K.a)(this.DATABASE_NAME,{blocked:function(){}});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"throwErrorIfIndexedDBNotInitialized",value:function(){if(!this._db)throw new Error(this.ERROR.INDEXEDDB_NOT_INITIALIZED)}},{key:"initIndexedDb",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._db){e.next=2;break}return e.abrupt("return");case 2:if("indexedDB"in window){e.next=5;break}throw new Error(this.ERROR.INDEXEDDB_NOT_SUPPORTED);case 5:return e.next=7,Object(K.b)(this.DATABASE_NAME,this.DATABASE_VERSION,{upgrade:function(e,t,n,r){t<=1&&e.createObjectStore("hyperlinks",{keyPath:"id",autoIncrement:!1}).createIndex("createdOn","createdOn")},blocked:function(){},blocking:function(){},terminated:function(){}});case 7:t=e.sent,this._db=t;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"convertArrayToObject",value:function(e,t){for(var n={},r=0;r<e.length;r++){var a=Object.assign({},e[r]);n[a[t]]=a}return n}}]),e}()),G=new(function(){function e(){Object(Z.a)(this,e)}return Object(q.a)(e,[{key:"getHyperlinks",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){setTimeout((function(){e()}),500)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"addOrUpdateHyperlink",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var n=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){setTimeout((function(){var r=n.alterSyncedHyperlink(t);e(r)}),500)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"alterSyncedHyperlink",value:function(e){var t=Object.assign({},e);return t.updatedOn=this.getISOTimestamp(),delete t.dirty,t}},{key:"getISOTimestamp",value:function(){return(new Date).toISOString()}}]),e}()),Q=new(function(){function e(){Object(Z.a)(this,e),this.hyperlinks={},this.ERROR={CREATE:"Cannot create hyperlink because object already has an id property",UPDATE:"Cannot update hyperlink because object has no id property",DELETE:"Cannot delete hyperlink because object has no id property"}}return Object(q.a)(e,[{key:"getHyperlinks",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getHyperlinksArraySorted().filter((function(e){return!e.deleted})),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createHyperlink",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var n,r,a,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.id){e.next=2;break}throw new Error(this.ERROR.CREATE);case 2:return n=this.generateUid(),r=this.getISOTimestamp(),a=Object(w.a)({id:n},t,{createdOn:r,updatedOn:r,dirty:!0}),i=Object(w.a)({},this.hyperlinks,Object(Y.a)({},n,a)),this.hyperlinks=i,e.abrupt("return",this.getHyperlinks());case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateHyperlink",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw new Error(this.ERROR.UPDATE);case 2:return n=Object(w.a)({},this.hyperlinks),r=this.getISOTimestamp(),(a=Object(w.a)({},n[t.id],{},t,{dirty:!0,updatedOn:r})).createdOn||(a.createdOn=r),n[a.id]=a,this.hyperlinks=n,e.abrupt("return",this.getHyperlinks());case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteHyperlink",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}throw new Error(this.ERROR.DELETE);case 2:return n=Object(w.a)({},t,{deleted:!0}),e.next=5,this.updateHyperlink(n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getHyperlinksArraySorted",value:function(){return Object.entries(this.hyperlinks).map((function(e){return e[1]})).sort(this.sortDescByISOTimestamp)}},{key:"generateUid",value:function(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}},{key:"getISOTimestamp",value:function(){return(new Date).toISOString()}},{key:"sortDescByISOTimestamp",value:function(e,t){return e.createdOn>t.createdOn?-1:e.createdOn<t.createdOn?1:0}},{key:"syncHyperlinks",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t,n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.getHyperlinksArraySorted().filter((function(e){return e.dirty})),n=0;case 2:if(!(n<t.length)){e.next=19;break}if(r=t[n],e.t0=G,!e.t0){e.next=9;break}return e.next=8,G.addOrUpdateHyperlink(r);case 8:e.t0=e.sent;case 9:if(!(a=e.t0)){e.next=16;break}if(this.updateSyncedHyperlink(a),e.t1=$,!e.t1){e.next=16;break}return e.next=16,$.addOrUpdateHyperlink(a);case 16:n++,e.next=2;break;case 19:return e.abrupt("return",this.getHyperlinks());case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateSyncedHyperlink",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=Object(w.a)({},this.hyperlinks))[t.id]=t,this.hyperlinks=n;case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchHyperlinks",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadLocalHyperlinks();case 2:return e.next=4,this.loadServerHyperlinks();case 4:return e.abrupt("return",this.getHyperlinks());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadLocalHyperlinks",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=$,!e.t0){e.next=4;break}return e.next=4,$.initIndexedDb();case 4:if(e.t1=$,!e.t1){e.next=9;break}return e.next=8,$.getHyperlinks();case 8:e.t1=e.sent;case 9:if(t=e.t1){e.next=12;break}return e.abrupt("return");case 12:this.hyperlinks=t;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadServerHyperlinks",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=G,!e.t0){e.next=5;break}return e.next=4,G.getHyperlinks();case 4:e.t0=e.sent;case 5:if(t=e.t0){e.next=8;break}return e.abrupt("return");case 8:this.hyperlinks=t;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initMockHyperlinks",value:function(){var e=Object(p.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.hyperlinks=t,e.t0=$,!e.t0){e.next=5;break}return e.next=5,this.loadLocalHyperlinks();case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetMockHyperlinks",value:function(){var e=Object(p.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=$,!e.t0){e.next=4;break}return e.next=4,$.deleteIndexedDb();case 4:this.hyperlinks={};case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}()),ee="Could not load hyperlinks",te="Could not sync hyperlinks",ne="Could not add hyperlink",re="Could not update hyperlink",ae="Could not delete hyperlink";function ie(e){return a.a.createElement(y.a,Object.assign({elevation:6,variant:"filled"},e))}var ce=Object(o.a)((function(e){return{root:{paddingTop:0,paddingBottom:0},progressBar:{position:"absolute",width:"100%"},progressBarHidden:{position:"absolute",width:"100%",opacity:0}}}));function oe(){var e=ce(),t=a.a.useState([]),n=Object(d.a)(t,2),r=n[0],i=n[1],c=a.a.useState(!1),o=Object(d.a)(c,2),u=o[0],s=o[1],y=a.a.useState(!1),m=Object(d.a)(y,2),b=m[0],E=m[1],O=a.a.useState(""),x=Object(d.a)(O,2),w=x[0],g=x[1],H=function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s(!0),e.next=4,Q.fetchHyperlinks();case 4:t=e.sent,i(t),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),T(ee),console.error(e.t0);case 12:return e.next=14,j();case 14:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();a.a.useEffect((function(){H()}),[]);var j=function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s(!0),e.next=4,Q.syncHyperlinks();case 4:t=e.sent,i(t),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),T(te),console.error(e.t0);case 12:return e.prev=12,s(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,8,12,15]])})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q.createHyperlink(t);case 3:n=e.sent,i(n),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),T(ne),console.error(e.t0);case 11:return e.next=13,j();case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q.updateHyperlink(t);case 3:n=e.sent,i(n),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),T(re),console.error(e.t0);case 11:return e.next=13,j();case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Q.deleteHyperlink(t);case 3:n=e.sent,i(n),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),T(ae),console.error(e.t0);case 11:return e.next=13,j();case 13:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),N=function(e,t){"clickaway"!==t&&E(!1)},T=function(e){E(!1),E(!0),g(e)},A=r.map((function(e){return a.a.createElement(a.a.Fragment,{key:e.id},a.a.createElement(W,{id:e.id,title:e.title,url:e.url,visited:e.visited,onUpdateHyperlink:function(e){return D(e)},onDeleteHyperlink:function(e){return I(e)}}),a.a.createElement(h.a,null))}));return a.a.createElement(a.a.Fragment,null,a.a.createElement(k.a,{open:b,autoHideDuration:6e3,onClose:N},a.a.createElement(ie,{onClose:N,severity:"error"},w)),u?a.a.createElement(v.a,{className:e.progressBar}):a.a.createElement(v.a,{className:e.progressBarHidden}),a.a.createElement(f.a,{className:e.root},a.a.createElement(h.a,null),a.a.createElement(R,{onSaveNewHyperlink:function(e){return S(e)}}),a.a.createElement(h.a,null),A))}var ue=Object(o.a)((function(e){return{app:{minHeight:"100%",display:"flex",flexDirection:"column"},appHeader:{paddingLeft:16,paddingRight:16,fontSize:"calc(8px + 1vmin)",backgroundColor:"#282c34",color:"white"},appHeaderH1:{marginTop:2,marginBottom:-10},appBody:{flex:1,backgroundColor:e.palette.background.default},appFooter:{paddingTop:8,paddingBottom:8,paddingLeft:16,paddingRight:16,fontSize:"calc(8px + 1vmin)",backgroundColor:"#282c34",color:"white"}}}));var se=function(){var e=ue(),t=(new Date).getFullYear();return a.a.createElement(u.a,{className:e.app},a.a.createElement("header",{className:e.appHeader},a.a.createElement("h1",{className:e.appHeaderH1},"Save Links for Later"),a.a.createElement("p",null,"What do you want to read, watch, play or listen to?")),a.a.createElement(u.a,{className:e.appBody},a.a.createElement(oe,null)),a.a.createElement("footer",{className:e.appFooter},"Copyright \xa9 ",t))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(se,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[80,1,2]]]);
//# sourceMappingURL=main.c575b9e6.chunk.js.map